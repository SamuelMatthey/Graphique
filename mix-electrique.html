<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mix électrique suisse — 2026 à 2106</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=DM+Sans:wght@400;500;700&display=swap');
  *{margin:0;padding:0;box-sizing:border-box}
  body{background:#0d1117;color:#c8d6e5;font-family:'DM Sans',system-ui,sans-serif;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:2rem 1rem}
  .wrap{width:100%;max-width:1100px;background:linear-gradient(145deg,#0d1117,#111820);border:1px solid #1a2030;border-radius:16px;padding:2rem;box-shadow:0 8px 40px rgba(0,0,0,.5);animation:fadeIn .8s ease-out}
  @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
  .surtitle{font-family:'JetBrains Mono',monospace;font-size:.7rem;color:#f9ca24;font-weight:700;letter-spacing:.12em;text-transform:uppercase;margin-bottom:.4rem}
  .title{font-size:1.4rem;font-weight:700;color:#fff;margin-bottom:.35rem}
  .subtitle{font-size:.82rem;color:#5a6a7a;margin-bottom:1.5rem}
  svg{width:100%;height:auto;display:block}
  .tooltip-box{position:absolute;pointer-events:none;background:rgba(13,17,23,.95);border:1px solid #1a2030;border-radius:8px;padding:12px 16px;font-size:12px;color:#c8d6e5;white-space:nowrap;z-index:10;opacity:0;transition:opacity .15s;box-shadow:0 4px 20px rgba(0,0,0,.4)}
  .tooltip-box.visible{opacity:1}
  .tt-title{font-family:'JetBrains Mono',monospace;font-weight:700;color:#fff;margin-bottom:6px;font-size:13px}
  .tt-row{display:flex;align-items:center;gap:8px;margin:3px 0}
  .tt-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
  .tt-sep{border-top:1px solid #1a2030;margin:6px 0}
  .legend{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}
  .legend-item{display:flex;align-items:center;gap:6px;font-size:.78rem;color:#7a8ba3}
  .legend-color{width:12px;height:10px;border-radius:2px}
  .chart-area{position:relative}
  @media(max-width:768px){.wrap{padding:1.2rem;border-radius:10px}.title{font-size:1.1rem}body{padding:1rem .5rem}}
</style>
</head>
<body>
<div class="wrap">
  <div class="surtitle">Évolution du mix électrique suisse — 2026 à 2106</div>
  <div class="title">Capacités de production et consommation — 2 EPR2 + 4 Transmutex</div>
  <div class="subtitle">Production par source (TWh/an) vs consommation estimée • Fermetures Beznau (2033), Gösgen (2039), Leibstadt (2044)</div>
  <div class="chart-area" id="chartArea">
    <svg id="chart" viewBox="0 0 1060 460"></svg>
    <div class="tooltip-box" id="tooltip"></div>
  </div>
  <div class="legend">
    <div class="legend-item"><div class="legend-color" style="background:#3498db"></div>Hydraulique</div>
    <div class="legend-item"><div class="legend-color" style="background:#e67e22"></div>Nucléaire existant</div>
    <div class="legend-item"><div class="legend-color" style="background:#2ecc71"></div>Renouvelables</div>
    <div class="legend-item"><div class="legend-color" style="background:#c8d6e5"></div>Nouveaux EPR2</div>
    <div class="legend-item"><div class="legend-color" style="background:#f9ca24"></div>Transmutex (thorium)</div>
    <div class="legend-item"><div class="legend-color" style="background:#ff6b6b;height:3px;border-radius:2px"></div>Consommation estimée</div>
  </div>
</div>
<script>
(function(){
const SY=2026,EY=2106,N=EY-SY+1;
const M={l:55,r:20,t:25,b:35},W=1060,H=460,pw=W-M.l-M.r,ph=H-M.t-M.b;
const YMAX=125;
function xP(i){return M.l+i/(N-1)*pw}
function yP(v){return M.t+(1-v/YMAX)*ph}
function hydro(y){return y<=2050?48+2*(y-2026)/24:50}
function nucEx(y){let t=0;if(y<2033)t+=6;else if(y<2034)t+=6*(2034-y);if(y<2039)t+=8;else if(y<2040)t+=8*(2040-y);if(y<2044)t+=9;else if(y<2045)t+=9*(2045-y);return t}
function renouv(y){if(y<=2026)return 9;if(y<=2035)return 9+5*(y-2026)/9;if(y<=2055)return 14+6*(y-2035)/20;return 20}
function up(mw){return mw/1e3*.85*8.76}
const eu=[{s:2038,m:1670},{s:2040,m:1670}],tu=[{s:2048,m:300},{s:2048,m:300},{s:2050,m:300},{s:2050,m:300}];
function epr2(y){let p=0;eu.forEach(u=>{if(y>=u.s){let o=y-u.s;if(o<=80)p+=up(u.m)*Math.min(1,o/2)}});return p}
function tmx(y){let p=0;tu.forEach(u=>{if(y>=u.s){let o=y-u.s;if(o<=80)p+=up(u.m)*Math.min(1,o/2)}});return p}
function conso(y){if(y<=2050)return 58+27*(y-2026)/24;return 85+10*Math.min(1,(y-2050)/30)}

const years=[],dH=[],dN=[],dR=[],dE=[],dT=[],dC=[];
for(let i=0;i<N;i++){let y=SY+i;years.push(y);dH.push(hydro(y));dN.push(nucEx(y));dR.push(renouv(y));dE.push(epr2(y));dT.push(tmx(y));dC.push(conso(y))}

// Cumulative stacks
const s1=dH.map(v=>v); // hydro top
const s2=s1.map((v,i)=>v+dN[i]); // +nuc
const s3=s2.map((v,i)=>v+dR[i]); // +renouv
const s4=s3.map((v,i)=>v+dE[i]); // +epr2
const s5=s4.map((v,i)=>v+dT[i]); // +tmx = total

const svg=document.getElementById('chart'),ns='http://www.w3.org/2000/svg';
function el(tag,a){let e=document.createElementNS(ns,tag);for(let k in a)e.setAttribute(k,a[k]);return e}

// Grid
for(let v=0;v<=YMAX;v+=20){let y=yP(v);svg.appendChild(el('line',{x1:M.l,x2:W-M.r,y1:y,y2:y,stroke:'#fff',opacity:.04}));let t=el('text',{x:M.l-8,y:y+4,'text-anchor':'end',fill:'#5a6a7a','font-size':10,'font-family':"'JetBrains Mono',monospace"});t.textContent=v;svg.appendChild(t)}
for(let y=2030;y<=2100;y+=10){let t=el('text',{x:xP(y-SY),y:H-M.b+20,'text-anchor':'middle',fill:'#5a6a7a','font-size':10,'font-family':"'JetBrains Mono',monospace"});t.textContent=y;svg.appendChild(t)}

// Stacked areas (bottom to top)
function areaPath(top,bot){
  let d='M';for(let i=0;i<N;i++)d+=(i?'L':'')+xP(i).toFixed(1)+','+yP(top[i]).toFixed(1);
  for(let i=N-1;i>=0;i--)d+='L'+xP(i).toFixed(1)+','+yP(bot?bot[i]:0).toFixed(1);
  return d+'Z';
}
const layers=[
  {top:s1,bot:null,c:'#3498db',o:.7},
  {top:s2,bot:s1,c:'#e67e22',o:.7},
  {top:s3,bot:s2,c:'#2ecc71',o:.7},
  {top:s4,bot:s3,c:'#c8d6e5',o:.55},
  {top:s5,bot:s4,c:'#f9ca24',o:.65},
];
layers.forEach(l=>{svg.appendChild(el('path',{d:areaPath(l.top,l.bot),fill:l.c,opacity:l.o}))});

// Consumption line
let cPath='M';dC.forEach((v,i)=>{cPath+=(i?'L':'')+xP(i).toFixed(1)+','+yP(v).toFixed(1)});
svg.appendChild(el('path',{d:cPath,fill:'none',stroke:'#ff6b6b','stroke-width':2.8,'stroke-linejoin':'round'}));

// Milestones
[{y:2033,l:'Beznau −6',c:'#ff6b6b'},{y:2039,l:'Gösgen −8',c:'#ff6b6b'},{y:2044,l:'Leibstadt −9',c:'#ff6b6b'},{y:2038,l:'EPR2-1',c:'#c8d6e5'},{y:2048,l:'TMX 1-2',c:'#f9ca24'}].forEach(m=>{
  let x=xP(m.y-SY);svg.appendChild(el('line',{x1:x,x2:x,y1:M.t,y2:H-M.b,stroke:m.c,opacity:.2,'stroke-dasharray':'3,3'}));
  let t=el('text',{x:x,y:M.t-5,'text-anchor':'middle',fill:m.c,opacity:.55,'font-size':8,'font-weight':600,'font-family':"'DM Sans',sans-serif"});t.textContent=m.l;svg.appendChild(t)});

// Hover
let hL=el('line',{x1:0,x2:0,y1:M.t,y2:H-M.b,stroke:'#fff','stroke-width':1,'stroke-dasharray':'3,3',opacity:0});svg.appendChild(hL);
const tip=document.getElementById('tooltip'),ca=document.getElementById('chartArea');
const names=['Hydraulique','Nuc. existant','Renouvelables','EPR2','Transmutex','Consommation'];
const colors=['#3498db','#e67e22','#2ecc71','#c8d6e5','#f9ca24','#ff6b6b'];
function show(e){let r=svg.getBoundingClientRect(),mx=(e.clientX-r.left)/r.width*W,idx=Math.round((mx-M.l)/pw*(N-1));if(idx<0||idx>=N){hide();return}idx=Math.max(0,Math.min(N-1,idx));let x=xP(idx);hL.setAttribute('x1',x);hL.setAttribute('x2',x);hL.style.opacity='.15';
let vals=[dH[idx],dN[idx],dR[idx],dE[idx],dT[idx],dC[idx]];
let total=vals[0]+vals[1]+vals[2]+vals[3]+vals[4];
let surplus=total-vals[5];
let h='<div class="tt-title">'+years[idx]+'</div>';
for(let i=0;i<6;i++){if(vals[i]>0.1||i===5)h+='<div class="tt-row"><div class="tt-dot" style="background:'+colors[i]+'"></div>'+names[i]+': '+vals[i].toFixed(1)+' TWh</div>'}
h+='<div class="tt-sep"></div><div class="tt-row">Production totale: '+total.toFixed(1)+' TWh</div>';
h+='<div class="tt-row">Bilan: '+(surplus>=0?'+':'')+surplus.toFixed(1)+' TWh</div>';
tip.innerHTML=h;tip.classList.add('visible');
let tx=e.clientX-ca.getBoundingClientRect().left+15,ty=e.clientY-ca.getBoundingClientRect().top-60;if(tx+220>ca.offsetWidth)tx-=250;tip.style.left=tx+'px';tip.style.top=Math.max(0,ty)+'px'}
function hide(){hL.style.opacity='0';tip.classList.remove('visible')}
svg.addEventListener('mousemove',show);svg.addEventListener('mouseleave',hide);svg.addEventListener('touchmove',e=>{e.preventDefault();show(e.touches[0])},{passive:false});svg.addEventListener('touchend',hide);
})();
</script>
</body>
</html>
